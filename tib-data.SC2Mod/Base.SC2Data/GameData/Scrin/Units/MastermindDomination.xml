<Catalog>
    <CUnit id="Nova">
        <AbilArray Link="Domination"/>
        <AbilArray Link="ReleaseMinion"/>
        <CardLayouts>
            <LayoutButtons Face="Domination" Type="AbilCmd" AbilCmd="Domination,Execute" Row="2" Column="1"/>
            <LayoutButtons Face="ReleaseMinion" Type="AbilCmd" AbilCmd="ReleaseMinion,Execute" Row="2" Column="2"/>
        </CardLayouts>
    </CUnit>
    <CAbilEffectTarget id="Domination">
        <EditorCategories value="Race:Terran,AbilityorEffectType:Units"/>
        <Effect index="0" value="DominationPersistent"/>
        <Flags index="AbortOnAllianceChange" value="0"/>
        <Cost>
            <Vital index="Energy" value="75"/>
        </Cost>
        <TargetFilters value="Visible;Player,Ally,Neutral,Robotic,Structure,Missile,Stasis,Dead,Invulnerable"/>
        <Range value="7"/>
        <CmdButtonArray index="Execute" DefaultButtonFace="Domination" Requirements="UseDomination"/>
        <CmdButtonArray index="Cancel" DefaultButtonFace="Cancel"/>
        <RangeSlop value="100"/>
        <AINotifyEffect value="DominationApplySet"/>
    </CAbilEffectTarget>
    <CAbilEffectInstant id="ReleaseMinion">
        <EditorCategories value="Race:Terran,AbilityorEffectType:Units"/>
        <Flags index="AllowMovement" value="1"/>
        <Flags index="NoDeceleration" value="1"/>
        <Flags index="RequireTargetVision" value="0"/>
        <Flags index="Transient" value="1"/>
        <AINotifyEffect value=""/>
        <CmdButtonArray index="Execute" DefaultButtonFace="ReleaseMinion" Requirements="UseReleaseMinion"/>
    </CAbilEffectInstant>

    <!-- Domination                                                                              -->
    <CActorRange id="DominationRange" parent="RangeAbil" abil="Domination"/>
    <CActorBeamSimple id="DominationBeam" parent="BeamSimpleAnimationStyleContinuous">
        <HostLaunch Subject="_Unit" Scope="Caster" Actor="Find"/>
        <HostLaunchSiteOps Ops="SOpAttachHead"/>
        <HostImpact Subject="_Unit" Scope="Target" Actor="Find"/>
        <HostImpactSiteOps Ops="SOpAttachHead"/>
        <AutoScaleFactor value="0.600000"/>
        <On Terms="Effect.DominationPersistent.Start" Send="Create"/>
        <On Terms="Effect.DominationPersistent.Stop" Send="Destroy"/>
    </CActorBeamSimple>
    <CActorModel id="DominationImpact" parent="ModelAnimationStyleContinuous">
        <AutoScaleFactor value="0.600000"/>
        <Host Subject="_Unit"/>
        <HostSiteOps Ops="SOpAttachCenter"/>
        <On Terms="Behavior.Domination.On" Send="Create"/>
        <On Terms="Behavior.Domination.Off" Send="Destroy"/>
    </CActorModel>
    <CActorSound id="NovaDominationSound" parent="SoundOneShot">
        <On Terms="Effect.DominationPersistent.Start" Send="Create"/>
    </CActorSound>
    <CActorSound id="Nova_DominationLoop" parent="SoundContinuous">
        <On Terms="Effect.DominationPersistent.Start" Send="Create"/>
        <On Terms="Effect.DominationPersistent.Stop" Send="Destroy"/>
    </CActorSound>
    <CActorSound id="Nova_DominationEnd" parent="SoundOneShot">
        <On Terms="Effect.DominationPersistent.Stop" Send="Create"/>
    </CActorSound>

    <CBehaviorBuff id="AlreadyDominating">
        <InfoFlags index="Hidden" value="1"/>
        <EditorCategories value="Race:Terran,AbilityorEffectType:Units"/>
    </CBehaviorBuff>
    <CBehaviorBuff id="Domination">
        <Alignment value="Negative"/>
        <InfoIcon value="Assets\Textures\BTN-Ability-terran-domination.dds"/>
        <EditorCategories value="Race:Terran,AbilityorEffectType:Units"/>
        <Player Value="Caster"/>
        <DisplayDuration index="Self" value="1"/>
    </CBehaviorBuff>

    <CButton id="Domination">
        <Icon value="Assets\Textures\BTN-Ability-terran-domination.dds"/>
        <EditorCategories value="Race:Terran"/>
        <TintRacially value="1"/>
    </CButton>
    <CButton id="ReleaseMinion">
        <Icon value="Assets\Textures\btn-command-cancel.dds"/>
        <EditorCategories value="Race:Terran"/>
    </CButton>

    <CEffectDestroyPersistent id="ReleaseMinion">
        <EditorCategories value="Race:Terran"/>
        <Effect value="DominationPersistent"/>
        <Count value="4294967295"/>
        <Radius value="500"/>
    </CEffectDestroyPersistent>


    <CEffectApplyBehavior id="DominationAB">
        <EditorCategories value="Race:Terran"/>
        <Behavior value="Domination"/>
    </CEffectApplyBehavior>
    <CEffectEnumArea id="DominationDummy">
        <EditorCategories value="Race:Terran"/>
        <AreaArray/>
    </CEffectEnumArea>
    <CEffectLaunchMissile id="DominationLM">
        <EditorCategories value="Race:Terran"/>
        <LaunchLocation Value="CasterUnit"/>
        <AmmoUnit value="DominationWeapon"/>
        <ImpactEffect value="DominationDummy"/>
        <ValidatorArray index="0" removed="1"/>
    </CEffectLaunchMissile>
    <CEffectCreatePersistent id="DominationPersistent">
        <EditorCategories value="Race:Terran"/>
        <WhichLocation Value="TargetUnit"/>
        <InitialEffect value="DominationApplySet"/>
        <FinalEffect value="DominationRemoveSet"/>
        <Flags index="PersistUntilDestroyed" value="1"/>
        <PeriodicValidator value="Domination"/>
        <PeriodicPeriodArray value="0.2"/>
    </CEffectCreatePersistent>
    <CEffectRemoveBehavior id="DominationRB">
        <EditorCategories value="Race:Terran"/>
        <BehaviorLink value="Domination"/>
    </CEffectRemoveBehavior>
    <CEffectSet id="DominationApplySet">
        <ValidatorArray value=""/>
        <EditorCategories value="Race:Terran"/>
        <EffectArray value="DominationAB"/>
        <EffectArray value="DominationApplyNova"/>
    </CEffectSet>
    <CEffectApplyBehavior id="DominationApplyNova">
        <ValidatorArray index="0" value=""/>
        <EditorCategories value="Race:Terran"/>
        <WhichUnit Value="Caster"/>
        <Behavior value="AlreadyDominating"/>
    </CEffectApplyBehavior>
    <CEffectRemoveBehavior id="DominationRemoveNova">
        <EditorCategories value="Race:Terran"/>
        <WhichUnit Value="Source"/>
        <BehaviorLink value="AlreadyDominating"/>
        <Count value="1"/>
    </CEffectRemoveBehavior>
    <CEffectSet id="DominationRemoveSet">
        <EditorCategories value="Race:Terran"/>
        <EffectArray value="DominationRemoveNova"/>
        <EffectArray value="DominationRB"/>
    </CEffectSet>

    <CModel id="DominationBeam" parent="PersistentSpellFX">
        <Model value="Assets\Effects\Terran\DominationBeam\DominationBeam.m3"/>
        <EditorCategories value="Race:Terran"/>
    </CModel>
    <CModel id="DominationImpact" parent="PersistentSpellFX">
        <Model value="Assets\Effects\Terran\DominationImpact\DominationImpact.m3"/>
        <EditorCategories value="Race:Terran"/>
    </CModel>

    <CRequirement id="UseDomination">
        <EditorCategories value="Race:Terran,TechType:Ability"/>
        <NodeArray index="Use" Link="NotCountBehaviorAlreadyDominatingInProgressOrBetter"/>
        <NodeArray index="Show" Link="NotCountBehaviorAlreadyDominatingInProgressOrBetter"/>
    </CRequirement>
    <CRequirement id="UseReleaseMinion">
        <EditorCategories value="Race:Terran,TechType:Ability"/>
        <NodeArray index="Show" Link="CountBehaviorAlreadyDominatingInProgressOrBetter"/>
    </CRequirement>
    <CRequirementCountBehavior id="CountBehaviorAlreadyDominatingInProgressOrBetter">
        <Count Link="AlreadyDominating" State="InProgressOrBetter"/>
        <Flags index="TechTreeCheat" value="0"/>
    </CRequirementCountBehavior>
    <CRequirementNot id="NotCountBehaviorAlreadyDominatingInProgressOrBetter">
        <OperandArray index="0" value="CountBehaviorAlreadyDominatingInProgressOrBetter"/>
    </CRequirementNot>


    <CSound id="Nova_DominationEnd">
        <Pitch value="-5.000000,0.000000"/>
        <Volume value="-7.000000,-7.000000"/>
    </CSound>
    <CSound id="Nova_DominationLoop">
        <Pitch value="-4.000000,-2.000000"/>
        <Volume value="-21.000000,-21.000000"/>
        <VolumeRolloffPoints Distance="15.000000"/>
        <VolumeRolloffPoints Distance="20.000000" Volume="-96.000000"/>
    </CSound>
    <CSound id="NovaDominationSound">
        <Pitch value="-5.000000,0.000000"/>
        <Volume value="-9.000000,-9.000000"/>
    </CSound>
</Catalog>