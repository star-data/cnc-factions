<?xml version="1.0" encoding="utf-8"?>
<Catalog>
    <CEffectEnumArea id="CNCMaintenanceGroundEA">
        <ImpactLocation Value="TargetUnit"/>
        <SearchFilters value="Ground,Mechanical;Ally,Neutral,Enemy,Biological,Structure,Stasis,Dead,Hidden"/>
        <AreaArray Radius="3" Effect="CNCMaintenanceGroundAB"/>
        <SearchFlags index="ExtendByUnitRadius" value="1"/>
    </CEffectEnumArea>
    <CEffectEnumArea id="CNCMaintenanceAirEA">
        <ImpactLocation Value="TargetUnit"/>
        <SearchFilters value="Air,Mechanical;Ally,Neutral,Enemy,Biological,Structure,Stasis,Dead,Hidden"/>
        <AreaArray Radius="3" Effect="CNCMaintenanceAirAB"/>
        <SearchFlags index="ExtendByUnitRadius" value="1"/>
    </CEffectEnumArea>
    <CEffectApplyBehavior id="CNCMaintenanceAirAB">
        <EditorCategories value="Race:Protoss"/>
        <Behavior value="CNCAwaitMaintenanceAir"/>
    </CEffectApplyBehavior>
    <CEffectApplyBehavior id="CNCMaintenanceGroundAB">
        <EditorCategories value="Race:Protoss"/>
        <Behavior value="CNCAwaitMaintenanceGround"/>
    </CEffectApplyBehavior>
    <CEffectCreateHealer id="CNCMaintenanceDroneRepair" parent="Repair">
        <Name value="Effect/Name/CNCMaintenanceDroneRepair"/>
        <ValidatorArray index="0" value="noMarkers"/>
        <ValidatorArray index="1" value="NotHidden"/>
        <ValidatorArray index="2" value="NotWarpingIn"/>
        <ValidatorArray index="3" value="NotThorWreckage"/>
        <ValidatorArray value="NotOdinWreckage"/>
        <ValidatorArray value="NotVortexd"/>
        <ValidatorArray value="NoSOATimeFreeze"/>
        <DrainResourceCostFactor index="Minerals" value="0"/>
        <DrainResourceCostFactor index="Vespene" value="0"/>
        <DrainResourceCostFactor index="Terrazine" value="0"/>
        <DrainResourceCostFactor index="Custom" value="0"/>
        <RechargeVitalRate value="10"/>
        <TimeFactor value="0"/>
        <FinalEffect value="CNCRepairDroneHeightRestore"/>
    </CEffectCreateHealer>
    <CEffectModifyUnit id="CNCRepairDroneHeightRestore">
        <EditorCategories value="Race:Terran"/>
        <ImpactUnit Value="Caster"/>
    </CEffectModifyUnit>
    <CEffectModifyUnit id="CNCMaintenanceDroneAirHeightStart">
        <EditorCategories value="Race:Terran"/>
        <ImpactUnit Value="Caster"/>
        <Height value="3.75"/>
        <HeightTime value="2"/>
    </CEffectModifyUnit>
    <CEffectModifyUnit id="CNCMaintenanceDroneGroundHeightStart">
        <EditorCategories value="Race:Terran"/>
        <ImpactUnit Value="Caster"/>
        <Height value="1.75"/>
        <HeightTime value="1"/>
    </CEffectModifyUnit>
    <CAbilArmMagazine id="CNCMaintenanceDrones">
        <EditorCategories value="Race:Nod,AbilityorEffectType:Units"/>
        <Launch value="ReleaseAtSource"/>
        <Flags index="AutoCreate" value="1"/>
        <Flags index="Retarget" value="1"/>
        <Flags index="ShowStatus" value="0"/>
        <Leash value="5"/>
        <InfoArray index="Ammo2" CountStart="3" Manage="Ignore" Unit="AlliedRepairBee">
            <Charge Link="Abil/##id##"/>
            <Cooldown Link="Abil/##id##"/>
            <Button DefaultButtonFace="CNCRepairDrones"/>
            <Flags index="AutoBuild" value="1"/>
            <Flags index="AutoBuildOn" value="1"/>
            <Flags index="External" value="1"/>
        </InfoArray>
        <MaxCount value="3"/>
    </CAbilArmMagazine>
    <CAbilEffectTarget id="CNCMaintenanceDroneRepairAir">
        <Effect index="0" value="CNCMaintenanceDroneRepair"/>
        <Alignment value="Positive"/>
        <AbilSetId value="Repair"/>
        <EditorCategories value="Race:Nod,AbilityorEffectType:Units"/>
        <Flags index="AutoCast" value="1"/>
        <Flags index="AutoCastOffOwnerLeave" value="1"/>
        <Flags index="AutoCastOn" value="1"/>
        <Flags index="BestUnit" value="0"/>
        <Flags index="ReExecutable" value="1"/>
        <Flags index="Smart" value="1"/>
        <Flags index="PassengerAcquirePassengers" value="1"/>
        <TargetFilters value="Mechanical,Visible;Self,Enemy,Missile,Stasis,UnderConstruction,Dead,Hidden"/>
        <Range value="0"/>
        <RangeSlop value="0"/>
        <AutoCastAcquireLevel value="Defensive"/>
        <AutoCastFilters value="Visible;Neutral,Enemy"/>
        <AutoCastRange value="8"/>
        <AutoCastValidatorArray value="CNCAwaitMaintenanceAirCheck"/>
        <AutoCastValidatorArray value="noMarkers"/>
        <InheritAttackPriorityArray index="Prep" value="1"/>
        <InheritAttackPriorityArray index="Cast" value="1"/>
        <InheritAttackPriorityArray index="Channel" value="1"/>
        <DefaultError value="RequiresRepairTarget"/>
        <CmdButtonArray index="Execute" DefaultButtonFace="Repair">
            <Flags index="ToSelection" value="1"/>
        </CmdButtonArray>
    </CAbilEffectTarget>
    <CAbilEffectTarget id="CNCMaintenanceDroneRepairGround">
        <Effect index="0" value="CNCMaintenanceDroneRepair"/>
        <Alignment value="Positive"/>
        <AbilSetId value="Repair"/>
        <EditorCategories value="Race:Nod,AbilityorEffectType:Units"/>
        <Flags index="AutoCast" value="1"/>
        <Flags index="AutoCastOffOwnerLeave" value="1"/>
        <Flags index="AutoCastOn" value="1"/>
        <Flags index="BestUnit" value="0"/>
        <Flags index="ReExecutable" value="1"/>
        <Flags index="Smart" value="1"/>
        <Flags index="PassengerAcquirePassengers" value="1"/>
        <TargetFilters value="Mechanical,Visible;Self,Enemy,Missile,Stasis,UnderConstruction,Dead,Hidden"/>
        <Range value="0"/>
        <RangeSlop value="0"/>
        <AutoCastAcquireLevel value="Defensive"/>
        <AutoCastFilters value="Visible;Neutral,Enemy"/>
        <AutoCastRange value="8"/>
        <AutoCastValidatorArray value="CNCAwaitMaintenanceGroundCheck"/>
        <AutoCastValidatorArray value="noMarkers"/>
        <InheritAttackPriorityArray index="Prep" value="1"/>
        <InheritAttackPriorityArray index="Cast" value="1"/>
        <InheritAttackPriorityArray index="Channel" value="1"/>
        <DefaultError value="RequiresRepairTarget"/>
        <CmdButtonArray index="Execute" DefaultButtonFace="Repair">
            <Flags index="ToSelection" value="1"/>
        </CmdButtonArray>
    </CAbilEffectTarget>
    <CValidatorUnitCompareBehaviorCount id="CNCAwaitMaintenanceAirCheck">
        <Value value="1"/>
        <Behavior value="CNCAwaitMaintenanceAir"/>
    </CValidatorUnitCompareBehaviorCount>
    <CValidatorUnitCompareBehaviorCount id="CNCAwaitMaintenanceGroundCheck">
        <Value value="1"/>
        <Behavior value="CNCAwaitMaintenanceGround"/>
    </CValidatorUnitCompareBehaviorCount>
    <CButton id="CNCRepairDrones">
        <Icon value="Assets\Textures\btn-ability-protoss-carrierrepairdrones.dds"/>
        <HotkeyAlias value="RepairDrones"/>
    </CButton>
    <CButton id="CNCMaintenanceDroneRepair">
        <Icon value="Assets\Textures\btn-ability-protoss-carrierrepairdrones.dds"/>
        <HotkeyAlias value="RepairDrones"/>
    </CButton>
    <!--    <BehaviorArray Link="CNCMaintenanceArea"/>           -->
    <!--    <LayoutButtons Face="CNCRepairDrones" Type="AbilCmd" AbilCmd="CNCMaintenanceDrones,Ammo2" Row="0" Column="4"/>-->
    <CActorRange id="CNCMaintenanceRange">
        <Inherits index="TeamColor" value="1"/>
        <On Terms="SelectionLocalUpdate.NodWarFactory.Start" Send="Create"/>
        <On Terms="SelectionLocalUpdate.NodWarFactory.StartEditorGround" Send="Create"/>
        <On Terms="SelectionLocalUpdate.NodWarFactory" Send="Create"/>
        <On Terms="SelectionLocalUpdate.NodWarFactory.Stop" Send="Destroy"/>
        <On Terms="SelectionLocalUpdate.NodAirTower.Start" Send="Create"/>
        <On Terms="SelectionLocalUpdate.NodAirTower.StartEditorGround" Send="Create"/>
        <On Terms="SelectionLocalUpdate.NodAirTower" Send="Create"/>
        <On Terms="SelectionLocalUpdate.NodAirTower.Stop" Send="Destroy"/>
        <On Terms="SelectionLocalUpdate.NodAirSupport.Start" Send="Create"/>
        <On Terms="SelectionLocalUpdate.NodAirSupport.StartEditorGround" Send="Create"/>
        <On Terms="SelectionLocalUpdate.NodAirSupport" Send="Create"/>
        <On Terms="SelectionLocalUpdate.NodAirSupport.Stop" Send="Destroy"/>
        <Weapon value="CNCMaintenanceWeaponDummy"/>
        <Icon value="Assets\Textures\radaricon2.dds"/>
        <IconArcLength value="0.300000"/>
    </CActorRange>
    <CActorSound id="CNCMaintenanceSound" parent="SoundOneShot">
        <On Terms="Effect.CNCMaintenanceDroneRepair.TargetStart" Send="Create"/>
        <On Terms="Effect.CNCMaintenanceDroneRepair.TargetStop" Send="Destroy"/>
    </CActorSound>
    <CActorModel id="CNCMaintenanceModel" parent="ModelAnimationStyleContinuous">
        <On Terms="ActorCreation" Send="$Birth PlayForever,ForceLooping"/>
        <On Terms="Effect.CNCMaintenanceDroneRepair.TargetStart" Send="Create"/>
        <On Terms="Effect.CNCMaintenanceDroneRepair.TargetStop" Send="Destroy"/>
        <On Terms="ActorOrphan" Send="Destroy"/>
        <Host Subject="_Selectable"/>
        <HostSiteOps Ops="SOpAttachOverhead"/>
    </CActorModel>
    <CModel id="CNCMaintenanceModel" parent="PersistentSpellFX">
        <Model value="Assets\Effects\Other\PhysicsImpactSparksLight\PhysicsImpactSparksLight.m3"/>
        <EditorCategories value="Race:Terran"/>
    </CModel>
    <CWeaponLegacy id="CNCMaintenanceWeaponDummy">
        <Range value="4"/>
    </CWeaponLegacy>
    <CSound id="CNCMaintenanceSound" parent="Gather">
        <EditorCategories value="Race:Terran"/>
        <AssetArray File="Assets\sounds\multifunctional-repair-tank-sound-effects.ogg" FacialGroup=""/>
        <DupeDestroyCount value="3"/>
        <Pitch value="-2.000000,0.000000"/>
        <Volume value="-10.000000,-7.000000"/>
    </CSound>
    <CBehaviorBuff id="CNCMaintenanceAreaGround">
        <InfoFlags index="Hidden" value="1"/>
        <Period value="1"/>
        <PeriodicEffect value="CNCMaintenanceGroundEA"/>
    </CBehaviorBuff>
    <CBehaviorBuff id="CNCMaintenanceAreaAir">
        <InfoFlags index="Hidden" value="1"/>
        <Period value="1"/>
        <PeriodicEffect value="CNCMaintenanceAirEA"/>
    </CBehaviorBuff>
    <CBehaviorBuff id="CNCAwaitMaintenanceAir">
        <InfoFlags index="Hidden" value="1"/>
        <InfoIcon value="Assets\Textures\btn-upgrade-swann-improvednanorepair.dds"/>
        <Duration value="2"/>
    </CBehaviorBuff>
    <CBehaviorBuff id="CNCAwaitMaintenanceGround">
        <InfoFlags index="Hidden" value="1"/>
        <InfoIcon value="Assets\Textures\btn-upgrade-swann-improvednanorepair.dds"/>
        <Duration value="2"/>
    </CBehaviorBuff>
    <CBehaviorWander id="CNCMaintenanceDroneWander">
        <Leash value="1"/>
        <Range value="4"/>
        <Delay value="2"/>
    </CBehaviorWander>
</Catalog>
