```
╔══════════════════════════════════════════════════════════════════════════════╗
║                    NOD DECOY ARMY - ABILITY FLOW DIAGRAM                     ║
╚══════════════════════════════════════════════════════════════════════════════╝

PHASE 1: ACTIVATION
═══════════════════════════════════════════════════════════════════════════════
┌─────────────────┐
│  Player clicks  │
│  Decoy Army     │
│  button on      │
│  Nod structure  │
└────────┬────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│  Ability: NodDecoyArmyTargeting                                             │
│  - Shows first targeting cursor                                             │
│  - Player selects SOURCE location (where units are)                         │
└────────┬────────────────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│  Trigger: libNOD_gt_DecoyArmyTargetingSticky_Func                           │
│  1. Creates NodDecoyArmyMarker unit at SOURCE point                         │
│  2. Adds marker to libNOD_gv_decoyMarkerTarget unit group                   │
│  3. Calls UISetTargetingOrder to enable second targeting                    │
└────────┬────────────────────────────────────────────────────────────────────┘
         │
         ▼

PHASE 2: EXECUTION
═══════════════════════════════════════════════════════════════════════════════
┌─────────────────────────────────────────────────────────────────────────────┐
│  Second targeting cursor appears                                            │
│  - Player selects DESTINATION location (where decoys will appear)           │
└────────┬────────────────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│  Ability: NodDecoyArmy_Execute                                              │
│  - Triggered on marker unit                                                 │
│  - Target point = DESTINATION                                               │
└────────┬────────────────────────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│  Trigger: libNOD_gt_DecoyArmyExecute_Func                                   │
│  1. Get SOURCE point (marker position)                                      │
│  2. Get DESTINATION point (EventUnitTargetPoint)                            │
│  3. Find all friendly ground units in 3.5 radius of SOURCE                  │
│  4. For each unit:                                                          │
│     a. Get unit type                                                        │
│     b. Create copy at DESTINATION                                           │
│     c. Apply NodDecoyBehavior (hallucination + instant death)               │
│     d. Apply NodDecoyTimedLife (60s auto-death)                             │
│     e. Match facing direction                                               │
│  5. Remove marker unit after 1 second                                       │
└────────┬────────────────────────────────────────────────────────────────────┘
         │
         ▼

PHASE 3: DECOY LIFECYCLE
═══════════════════════════════════════════════════════════════════════════════
┌─────────────────────────────────────────────────────────────────────────────┐
│  Decoy Units Active                                                         │
│  ✓ Controllable by player                                                   │
│  ✓ Reveal fog of war (sight = 11)                                           │
│  ✓ Appear translucent (hallucination flag)                                  │
│  ✓ Deal NO damage (hallucination prevents damage)                           │
│  ✓ Die instantly when attacked (DamageResponse kills unit)                  │
│  ✓ Auto-vaporize after 60 seconds (NodDecoyTimedLife)                       │
└─────────────────────────────────────────────────────────────────────────────┘

PHASE 4: CANCELLATION (Optional)
═══════════════════════════════════════════════════════════════════════════════
┌─────────────────────────────────────────────────────────────────────────────┐
│  If player cancels before second click:                                     │
│  - Trigger: libNOD_gt_DecoyArmyCancel_Func                                  │
│  - Removes all NodDecoyArmyMarker units                                     │
│  - Clears libNOD_gv_decoyMarkerTarget unit group                            │
└─────────────────────────────────────────────────────────────────────────────┘


╔══════════════════════════════════════════════════════════════════════════════╗
║                           SPATIAL DIAGRAM                                    ║
╚══════════════════════════════════════════════════════════════════════════════╝

STEP 1: Player clicks SOURCE location
═══════════════════════════════════════════════════════════════════════════════

    ┌────────────────────────────────────┐
    │         SOURCE AREA                │
    │                                    │
    │    [Tank]  [Tank]  [Infantry]      │
    │                                    │
    │    [Infantry]  [Buggy]             │
    │                                    │
    │         ⊕ Marker spawns here       │
    │         (radius 3.5)               │
    └────────────────────────────────────┘
                    │
                    │ Units within 3.5 radius
                    │ are identified for cloning
                    ▼


STEP 2: Player clicks DESTINATION location
═══════════════════════════════════════════════════════════════════════════════

    ┌────────────────────────────────────┐
    │      DESTINATION AREA              │
    │                                    │
    │    [Tank*] [Tank*] [Infantry*]     │  * = Decoy copies
    │                                    │
    │    [Infantry*] [Buggy*]            │
    │                                    │
    │         ⊕ Target point             │
    │         (decoys spawn here)        │
    └────────────────────────────────────┘


╔══════════════════════════════════════════════════════════════════════════════╗
║                        KEY DATA STRUCTURES                                   ║
╚══════════════════════════════════════════════════════════════════════════════╝

Global Variables:
─────────────────────────────────────────────────────────────────────────────
unitgroup libNOD_gv_decoyMarkerTarget
    Purpose: Tracks marker units for second targeting phase
    Lifecycle: Created on first click, cleared after execution/cancel


Abilities:
─────────────────────────────────────────────────────────────────────────────
1. NodDecoyArmyTargeting
   - First stage ability
   - Creates marker, enables second targeting
   - Cooldown: 120 seconds

2. NodDecoyArmy_Execute
   - Second stage ability
   - Attached to marker unit
   - Executes cloning logic


Behaviors:
─────────────────────────────────────────────────────────────────────────────
1. NodDecoyBehavior
   - Hallucination flag (no damage, translucent)
   - RevealUnit flag (fog of war)
   - DamageResponse: Instant death on hit

2. NodDecoyTimedLife
   - Duration: 60 seconds
   - Auto-removes unit when expired


Units:
─────────────────────────────────────────────────────────────────────────────
1. NodDecoyArmyMarker
   - Invisible, invulnerable
   - Placed at SOURCE location
   - Has NodDecoyArmy_Execute ability
   - Auto-removed after 1 second

2. NodDecoyUnit (template)
   - Base template for decoys
   - Actual decoys are cloned from source units
   - Has NodDecoyBehavior and NodDecoyTimedLife


╔══════════════════════════════════════════════════════════════════════════════╗
║                          COMPARISON TO CHRONOSPHERE                          ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌──────────────────────┬──────────────────────┬──────────────────────────────┐
│     Feature          │   Chronosphere       │   Decoy Army                 │
├──────────────────────┼──────────────────────┼──────────────────────────────┤
│ Targeting            │ Two-stage            │ Two-stage (same pattern)     │
│ First Click          │ Select source units  │ Select source units          │
│ Second Click         │ Teleport destination │ Decoy spawn destination      │
│ Unit Modification    │ Teleports originals  │ Creates copies               │
│ Unit Behavior        │ Invulnerability buff │ Hallucination + instant death│
│ Duration             │ 5 seconds            │ 60 seconds                   │
│ Fog of War           │ Reveals area         │ Decoys reveal fog            │
│ Damage               │ Normal damage        │ No damage (hallucination)    │
│ Death on Hit         │ No                   │ Yes (instant vaporize)       │
│ Cooldown             │ 180 seconds          │ 120 seconds                  │
└──────────────────────┴──────────────────────┴──────────────────────────────┘


╔══════════════════════════════════════════════════════════════════════════════╗
║                            INTEGRATION CHECKLIST                             ║
╚══════════════════════════════════════════════════════════════════════════════╝

XML Integration:
─────────────────────────────────────────────────────────────────────────────
☐ Include DecoyArmy_Implementation.xml in main catalog
☐ Add NodDecoyArmyTargeting ability to desired unit
☐ Add button to unit's command card layout
☐ Verify all IDs are unique (no conflicts with existing data)

Galaxy Script Integration:
─────────────────────────────────────────────────────────────────────────────
☐ Declare libNOD_gv_decoyMarkerTarget variable
☐ Initialize variable in InitVariables function
☐ Call trigger Init functions in InitTriggers
☐ Verify trigger names don't conflict with existing triggers

Testing:
─────────────────────────────────────────────────────────────────────────────
☐ Ability button appears and is clickable
☐ First click shows targeting cursor
☐ Marker spawns at first click location
☐ Second targeting cursor appears
☐ Decoys spawn at second click location
☐ Decoys match source unit types
☐ Decoys are controllable
☐ Decoys reveal fog of war
☐ Decoys deal no damage
☐ Decoys die instantly when attacked
☐ Decoys auto-vaporize after 60 seconds
☐ Ability goes on cooldown
☐ Cancel removes markers properly

```
