<Catalog>
    <CAbilEffectTarget id="CNCCaptureHusk">
        <EditorCategories value="AbilityorEffectType:Units,Race:Nod"/>
        <Range value="0.5"/>
        <CastIntroTime value="0.125"/>
        <CmdButtonArray index="Execute" DefaultButtonFace="NodSabotage"/>
        <CmdButtonArray index="Cancel" DefaultButtonFace="Cancel"/>
        <DefaultError value="RequiresRepairTarget"/>
        <Effect index="0" value="CNCCaptureHusk"/>
        <UninterruptibleArray index="Channel" value="1"/>
        <CancelableArray index="Channel" value="1"/>
    </CAbilEffectTarget>
    <CEffectSet id="CNCCaptureHusk">
        <ValidatorArray value="TargetLifeFull"/>
        <EffectArray value="CNCCaptureHuskSet"/>
    </CEffectSet>
    <CEffectSet id="CNCCaptureHuskSet">
        <ValidatorArray value="IsCNCHusk"/>
        <ValidatorArray value="CNCHuskNotReborning"/>
        <EffectArray value="NodSabotageChangeOwner"/>
        <EffectArray value="SuicideRemove"/>
        <EffectArray value="CNCCaptureHuskSwitch"/>
    </CEffectSet>
    <CEffectSet id="CNCCaptureHuskSetWithHeal">
        <ValidatorArray value="IsCNCHusk"/>
        <ValidatorArray value="CNCHuskNotReborning"/>
        <EffectArray value="NodSabotageHeal"/>
        <EffectArray value="CNCCaptureHuskSet"/>
    </CEffectSet>
    <CEffectSwitch id="CNCCaptureHuskSwitch">
        <CaseArray Validator="IsNodPurifierWreckage" Effect="NodPurifierRebornIO"/>
        <CaseArray Validator="IsNodAvatarWreckage" Effect="NodAvatarRebornIO"/>
    </CEffectSwitch>
    <CValidatorCombine id="CNCHuskNotReborning">
        <CombineArray value="NodAvatarNotReborning"/>
    </CValidatorCombine>
    <CValidatorCombine id="IsCNCHusk">
        <CombineArray value="IsNodAvatarWreckage"/>
    </CValidatorCombine>

    <CEffectSet id="NodSabotage">
        <ValidatorArray value="NodSabotageTargetFilters"/>
        <EffectArray value="NodSabotageHeal"/>
        <EffectArray value="NodSabotageChangeOwner"/>
        <EffectArray value="SuicideRemove"/>
        <EditorCategories value="Race:UPL"/>
    </CEffectSet>
    <CEffectCreateHealer id="NodSabotageHeal">
        <LaunchUnit Value="Target"/>
        <Flags index="Channeled" value="0"/>
        <PeriodCount value="80"/>
        <PeriodicPeriod value="0.125"/>
        <RechargeVitalRate value="250"/>
        <EditorCategories value="Race:UPL"/>
    </CEffectCreateHealer>

    <CAbilEffectTarget id="NodSabotage">
        <EditorCategories value="AbilityorEffectType:Units,Race:Nod"/>
        <Range value="0.5"/>
        <CastIntroTime value="0.125"/>
        <CmdButtonArray index="Execute" DefaultButtonFace="NodSabotage"/>
        <CmdButtonArray index="Cancel" DefaultButtonFace="Cancel"/>
        <DefaultError value="RequiresRepairTarget"/>
        <Effect index="0" value="NodSabotageSwitch"/>
        <UninterruptibleArray index="Channel" value="1"/>
        <CancelableArray index="Channel" value="1"/>
    </CAbilEffectTarget>
    <CEffectSwitch id="NodSabotageSwitch">
        <EditorCategories value="Race:Protoss"/>
        <CaseArray Validator="IsCNCHusk" Effect="CNCCaptureHuskSetWithHeal"/>
        <CaseArray Validator="IsEnemyOrNeutral" Effect="NodChannelSabotageInitialSet"/>
        <CaseDefault value="NodSabotage"/>
    </CEffectSwitch>
    <CEffectModifyUnit id="NodSabotageChangeOwner">
        <ValidatorArray value="TargetIsEnemyOrNeutral"/>
        <ModifyFlags index="Owner" value="1"/>
        <ModifyOwnerPlayer Value="Caster"/>
        <ImpactUnit Value="Target"/>
    </CEffectModifyUnit>
    <CEffectSet id="NodChannelSabotageInitialSet">
        <EditorCategories value="Race:Terran"/>
        <EffectArray value="NodChannelSabotageCreatePersistent"/>
        <EffectArray value="NodChannelSabotageCombat"/>
    </CEffectSet>
    <CEffectApplyBehavior id="NodChannelSabotageCombat">
        <EditorCategories value="Race:Terran"/>
        <WhichUnit Value="Caster"/>
    </CEffectApplyBehavior>
    <CEffectRemoveBehavior id="NodChannelSabotageCombatRB">
        <EditorCategories value="Race:Terran"/>
        <WhichUnit Value="Caster"/>
        <BehaviorLink value="NodChannelSabotageCombat"/>
    </CEffectRemoveBehavior>
    <CEffectCreatePersistent id="NodChannelSabotageCreatePersistent">
        <EditorCategories value="Race:Terran"/>
        <Flags index="Channeled" value="1"/>
        <ExpireEffect value="NodSabotage"/>
        <PeriodCount value="128"/>
        <PeriodicValidator value="NodChannelSabotageValidators"/>
        <PeriodicPeriodArray value="0.0625"/>
        <WhichLocation Value="TargetUnit"/>
        <FinalEffect value="NodChannelSabotageCombatRB"/>
    </CEffectCreatePersistent>
</Catalog>