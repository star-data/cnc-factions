<Catalog>
    <CAbilEffectTarget id="CNCCaptureHusk">
        <EditorCategories value="AbilityorEffectType:Units,Race:Nod"/>
        <Range value="0.5"/>
        <CastIntroTime value="0.125"/>
        <CmdButtonArray index="Execute" DefaultButtonFace="NodSabotage"/>
        <CmdButtonArray index="Cancel" DefaultButtonFace="Cancel"/>
        <DefaultError value="RequiresRepairTarget"/>
        <Effect index="0" value="CNCCaptureHusk"/>
        <UninterruptibleArray index="Channel" value="1"/>
        <CancelableArray index="Channel" value="1"/>
    </CAbilEffectTarget>
    <CEffectSet id="CNCCaptureHusk">
        <ValidatorArray value="TargetLifeFull"/>
        <EffectArray value="CNCCaptureHuskSwitch"/>
    </CEffectSet>
    <CEffectSwitch id="CNCCaptureHuskSwitch">
        <ValidatorArray value="NodAvatarNotReborning"/>
        <!--        <CaseArray Validator="TargetIsNodPurifierWreckage" Effect="NodPurifierWreckageCaptureSet"/>-->
        <CaseArray Validator="IsNodAvatarWreckage" Effect="NodAvatarWreckageCaptureSet"/>
    </CEffectSwitch>
    <CEffectSet id="NodAvatarWreckageCaptureSet">
        <EffectArray value="NodSabotageHeal"/>
        <EffectArray value="NodSabotageChangeOwner"/>
        <EffectArray value="NodAvatarRebornIO"/>
        <EffectArray value="SuicideRemove"/>
    </CEffectSet>
    <CValidatorCombine id="IsCNCHusk">
        <CombineArray value="IsNodAvatarWreckage"/>
    </CValidatorCombine>


    <CAbilEffectTarget id="NodSabotage">
        <EditorCategories value="AbilityorEffectType:Units,Race:Nod"/>
        <Range value="0.5"/>
        <CastIntroTime value="0.125"/>
        <!--        <EditorCategories value="Race:Terran,AbilityorEffectType:Units"/>-->
        <!--        <Effect index="0" value="NodChannelSabotageInitialSet"/>-->
        <!--        <TargetFilters value="Biological,Visible;Self,Player,Ally,Structure,Destructible,Stasis,Dead,Hidden,Invulnerable"/>-->
        <!--        <Range value="10"/>-->
        <CmdButtonArray index="Execute" DefaultButtonFace="NodSabotage"/>
        <CmdButtonArray index="Cancel" DefaultButtonFace="Cancel"/>
        <DefaultError value="RequiresRepairTarget"/>
        <Effect index="0" value="NodSabotageSwitch"/>
        <!--        <RangeSlop value="20"/>-->
        <!--                <UninterruptibleArray index="Cast" value="1"/>-->
        <UninterruptibleArray index="Channel" value="1"/>
        <CancelableArray index="Channel" value="1"/>
    </CAbilEffectTarget>
    <CEffectSwitch id="NodSabotageSwitch">
        <EditorCategories value="Race:Protoss"/>
        <CaseArray Validator="IsCNCHusk" Effect="CNCCaptureHuskSwitch"/>
        <CaseArray Validator="IsEnemyOrNeutral" Effect="NodChannelSabotageInitialSet"/>
        <CaseDefault value="NodSabotage"/>
    </CEffectSwitch>
    <CEffectModifyUnit id="NodSabotageChangeOwner">
        <ValidatorArray value="TargetIsEnemyOrNeutral"/>
        <ModifyFlags index="Owner" value="1"/>
        <ModifyOwnerPlayer Value="Caster"/>
<!--        <ImpactUnit Effect="NodSabotageSwitch"/>-->
        <ImpactUnit Value="Target"/>
    </CEffectModifyUnit>
    <CEffectSet id="NodChannelSabotageInitialSet">
        <EditorCategories value="Race:Terran"/>
        <EffectArray value="NodChannelSabotageCreatePersistent"/>
        <EffectArray value="NodChannelSabotageCombat"/>
    </CEffectSet>
    <CEffectApplyBehavior id="NodChannelSabotageCombat">
        <EditorCategories value="Race:Terran"/>
        <WhichUnit Value="Caster"/>
    </CEffectApplyBehavior>
    <CEffectRemoveBehavior id="NodChannelSabotageCombatRB">
        <EditorCategories value="Race:Terran"/>
        <WhichUnit Value="Caster"/>
        <BehaviorLink value="NodChannelSabotageCombat"/>
    </CEffectRemoveBehavior>
    <CEffectCreatePersistent id="NodChannelSabotageCreatePersistent">
        <EditorCategories value="Race:Terran"/>
        <Flags index="Channeled" value="1"/>
        <ExpireEffect value="NodSabotage"/>
        <PeriodCount value="128"/>
        <PeriodicValidator value="NodChannelSabotageValidators"/>
        <PeriodicPeriodArray value="0.0625"/>
        <WhichLocation Value="TargetUnit"/>
        <FinalEffect value="NodChannelSabotageCombatRB"/>
    </CEffectCreatePersistent>
</Catalog>