<Catalog>
    <CActorUnit id="NodFanatic" icon="Fanatic" parent="NodInfantry"/>
    <CActorAction id="NodFanaticExplosion" parent="GenericAttack" effectLaunch="NodFanaticExplosionU">
        <!--            <LaunchAssets Sound="Baneling_AttackLaunch"/>-->
        <ImpactMap index="None" Sound="NodHallucinogenicGrenadeImpact"/>
    </CActorAction>
    <CActorAction id="NodFanaticExplosion2" parent="GenericAttack" effectLaunch="NodFanaticExplosionU2">
        <!--            <LaunchAssets Sound="Baneling_AttackLaunch"/>-->
        <ImpactMap index="None" Model="NodFanaticExplosionImpact" Sound="NodHallucinogenicGrenadeImpact"/>
    </CActorAction>
    <CActorForceSphere id="NodFanaticAttackForce">
        <On Terms="Effect.NodFanaticExplosionU.Start; At Caster" Send="Create"/>
        <On Terms="ActorCreation" Send="Create NodFanaticAttackForceUp"/>
        <HostSiteOps Ops="SOpShadow SOpRandomPointInCircleDot25"/>
        <Duration value="0.300000"/>
        <Magnitude value="16.000000,8.000000"/>
        <Radius value="2.100000,0.300000"/>
    </CActorForceSphere>
    <CActorForceSphere id="NodFanaticAttackForceUp">
        <HostSiteOps Ops="SOpShadow SOpRotVariancerUp35"/>
        <Field value="Directional"/>
        <Duration value="0.500000"/>
        <Magnitude value="15.000000,5.000000"/>
        <Radius value="1.900000,0.300000"/>
    </CActorForceSphere>
    <CActorAction id="NodFanaticAttackDirect" parent="GenericAttack" effectAttack="NodFanaticExplosionFriendlyUnitDamage">
        <On Terms="Effect.NodFanaticExplosionDirectFallbackEnemyNeutralUnit.Stop; FromEffectTreeDescendant" Send="ActionImpactPhysics"/>
        <On Terms="Effect.NodFanaticExplosionDirectFallbackEnemyNeutralUnit.Start; At Caster" Send="Create"/>
        <On Terms="Effect.NodFanaticExplosionDirectFallbackEnemyNeutralBuilding.Stop; FromEffectTreeDescendant" Send="ActionImpactPhysics"/>
        <On Terms="Effect.NodFanaticExplosionDirectFallbackEnemyNeutralBuilding.Start; At Caster" Send="Create"/>
        <On Terms="Effect.NodFanaticExplosionFriendlyBuildingDamage.Stop; FromEffectTreeDescendant" Send="ActionImpactPhysics"/>
        <On Terms="Effect.NodFanaticExplosionFriendlyBuildingDamage.Start; At Caster" Send="Create"/>
    </CActorAction>


    <CAbilEffectInstant id="NodFanaticExplode">
        <EditorCategories value="Race:Nod,AbilityorEffectType:Units"/>
        <Effect index="0" value="NodFanaticExplosion"/>
        <CmdButtonArray index="Execute" DefaultButtonFace="NodFanaticExplode"/>
        <Flags index="AutoCast" value="1"/>
        <Flags index="AutoCastOn" value="1"/>
        <Cost>
            <Cooldown TimeUse="1"/>
        </Cost>
        <AutoCastRange value="1.25"/>
        <AutoCastFilters value="Ground,Visible;Structure,Self,Player,Ally,Missile,Stasis,Dead,Hidden,Invulnerable"/>
        <AutoCastValidatorArray value="NodFanaticExplodeEnemyCheck"/>
    </CAbilEffectInstant>
    <CValidatorLocationEnumArea id="NodFanaticExplodeEnemyCheck">
        <WhichLocation Value="CasterUnit"/>
        <AreaArray Compare="GE" Count="1" Radius="1"/>
        <SearchFilters value="Ground,Visible;Structure,Self,Player,Ally,Missile,Stasis,Dead,Hidden,Invulnerable"/>
    </CValidatorLocationEnumArea>
    <CAbilBehavior id="NodFanaticExplosionBuilding">
        <EditorCategories value="Race:Nod,AbilityorEffectType:Units"/>
        <CmdButtonArray index="On" DefaultButtonFace="EnableBuildingAttack">
            <Flags index="ToSelection" value="1"/>
        </CmdButtonArray>
        <CmdButtonArray index="Off" DefaultButtonFace="DisableBuildingAttack">
            <Flags index="ToSelection" value="1"/>
        </CmdButtonArray>
        <Flags index="Toggle" value="1"/>
        <Flags index="Transient" value="1"/>
        <BehaviorArray value="NodFanaticExplosionBuilding"/>
    </CAbilBehavior>
    <CWeaponLegacy id="NodFanaticExplosionDummy" parent="NodWeapon" icon="btn-nod-upgrade-lightweapons">
        <Options index="Melee" value="1"/>
        <DisplayEffect value="NodFanaticExplosionU"/>
        <TargetFilters value="Ground,Visible;Structure,Missile,Stasis,Dead,Hidden,Invulnerable"/>
        <Range value="0.25"/>
        <Cost>
            <Cooldown Link="Weapon/NodFanaticExplosion"/>
        </Cost>
        <Period value="0.833"/>
        <DamagePoint value="0"/>
        <LegacyOptions index="NoDeceleration" value="1"/>
        <AllowedMovement value="Moving"/>
        <Effect value=""/>
    </CWeaponLegacy>
    <CWeaponLegacy id="NodFanaticExplosion" parent="NodWeapon" icon="btn-nod-upgrade-lightweapons">
        <TargetFilters value="Ground,Visible;Missile,Stasis,Dead,Hidden,Invulnerable"/>
        <Range value="0.25"/>
        <Period value="0.833"/>
        <DamagePoint value="0"/>
        <AllowedMovement value="Moving"/>
        <Options index="Hidden" value="1"/>
        <Options index="Melee" value="1"/>
        <LegacyOptions index="NoDeceleration" value="1"/>
        <AcquireFilters value="Ground,Visible;Self,Player,Ally,Neutral,Structure,Missile,Stasis,Dead,Hidden,Invulnerable"/>
        <Marker>
            <MatchFlags index="Id" value="1"/>
        </Marker>
    </CWeaponLegacy>
    <CWeaponLegacy id="NodFanaticExplosionBuilding" parent="NodWeapon" icon="btn-nod-upgrade-lightweapons">
        <Options index="Disabled" value="1"/>
        <Options index="Hidden" value="1"/>
        <Options index="Melee" value="1"/>
        <DisplayEffect value="VolatileBurst"/>
        <TargetFilters value="Ground,Visible;Missile,Stasis,Dead,Hidden,Invulnerable"/>
        <AcquireFilters value="Ground,Visible;Self,Player,Ally,Neutral,Missile,Stasis,Dead,Hidden,Invulnerable"/>
        <Range value="0.25"/>
        <Period value="0.833"/>
        <DamagePoint value="0"/>
        <LegacyOptions index="NoDeceleration" value="1"/>
        <AllowedMovement value="Moving"/>
        <Effect value="VolatileBurst"/>
        <Marker>
            <MatchFlags index="Id" value="1"/>
        </Marker>
    </CWeaponLegacy>
    <CEffectDamage id="NodFanaticExplosionU2" parent="NodDamage">
        <AINotifyFlags index="HurtEnemy" value="1"/>
        <ImpactLocation Value="CasterUnit"/>
        <Kind value="Splash"/>
        <KindSplash value="Splash"/>
        <Amount value="80"/>
        <Death value="Blast"/>
        <AreaArray Radius="2.2" Fraction="1"/>
        <ExcludeArray Value="Outer"/>
        <SearchFilters value="Ground,Structure;Self,Player,Ally,Missile,Stasis,Dead,Hidden,Invulnerable"/>
    </CEffectDamage>
    <CEffectDamage id="NodFanaticExplosionFriendlyBuildingDamage" parent="NodFanaticExplosionU2">
        <AINotifyFlags index="HurtEnemy" value="0"/>
        <ImpactLocation Value="TargetUnit"/>
        <AreaArray index="0" removed="1"/>
        <ExcludeArray index="0" removed="1"/>
        <SearchFilters value="-;-"/>
        <SearchFlags index="SameCliff" value="0"/>
    </CEffectDamage>
    <CEffectDamage id="NodFanaticExplosionU" parent="NodDamage">
        <Amount value="16"/>
        <SearchFilters value="Ground;Player,Ally,Structure,Missile,Stasis,Dead,Hidden,Invulnerable"/>
        <AreaArray Radius="2.2" Fraction="1"/>
        <ExcludeArray Value="Outer"/>
        <ImpactLocation Value="CasterUnit"/>
        <Kind value="Splash"/>
        <KindSplash value="Splash"/>
        <Death value="Blast"/>
        <AINotifyFlags index="HurtEnemy" value="1"/>
        <AttributeBonus index="Light" value="19"/>
    </CEffectDamage>
    <CEffectDamage id="NodFanaticExplosionFriendlyUnitDamage" parent="NodFanaticExplosionU">
        <AINotifyFlags index="HurtEnemy" value="0"/>
        <ImpactLocation Value="TargetUnit"/>
        <AreaArray index="0" removed="1"/>
        <ExcludeArray index="0" removed="1"/>
        <SearchFilters value="-;-"/>
        <SearchFlags index="SameCliff" value="0"/>
    </CEffectDamage>
    <CEffectDamage id="NodFanaticExplosionDirectFallbackEnemyNeutralBuilding" parent="NodFanaticExplosionU2">
        <AreaArray index="0" removed="1"/>
        <ExcludeArray index="0" removed="1"/>
        <SearchFlags index="SameCliff" value="0"/>
        <Name value="Effect/Name/NodFanaticExplosionDirectFallbackEnemyNeutralBuilding"/>
        <ValidatorArray value="NodFanaticExplosionFallbackEnemyNeutralBuilding"/>
        <ValidatorArray value="noMarkers"/>
        <ImpactLocation Value="TargetUnit"/>
        <SearchFilters value="-;-"/>
    </CEffectDamage>
    <CEffectDamage id="NodFanaticExplosionDirectFallbackEnemyNeutralUnit" parent="NodFanaticExplosionU">
        <AreaArray index="0" removed="1"/>
        <ExcludeArray index="0" removed="1"/>
        <SearchFlags index="SameCliff" value="0"/>
        <Name value="Effect/Name/NodFanaticExplosionDirectFallbackEnemyNeutralUnit"/>
        <ValidatorArray value="NodFanaticExplosionFallbackEnemyNeutralUnit"/>
        <ValidatorArray value="noMarkers"/>
        <ImpactLocation Value="TargetUnit"/>
        <SearchFilters value="-;-"/>
    </CEffectDamage>
    <CEffectSwitch id="NodSuicideTargetFriendlySwitch">
        <ValidatorArray value="FriendlyTarget"/>
        <CaseArray Validator="IsStructure" Effect="NodFanaticExplosionFriendlyBuildingDamage"/>
        <CaseDefault value="NodFanaticExplosionFriendlyUnitDamage"/>
    </CEffectSwitch>
    <CEffectSet id="NodFanaticExplosion">
        <ValidatorArray value="CasterIsNotHidden"/>
        <EffectArray value="NodFanaticDontExplode"/>
        <EffectArray value="NodSuicideTargetFriendlySwitch"/>
        <EffectArray value="NodFanaticExplosionU2"/>
        <EffectArray value="NodFanaticExplosionU"/>
        <EffectArray value="NodFanaticExplosionDirectFallbackSet"/>
        <EffectArray value="Suicide"/>
    </CEffectSet>
    <CEffectRemoveBehavior id="NodFanaticDontExplode">
        <BehaviorLink value="NodFanaticExplode"/>
    </CEffectRemoveBehavior>
    <CEffectSet id="NodFanaticExplosionDirectFallbackSet">
        <ValidatorArray value="CliffLevelNotEqual"/>
        <EffectArray value="NodFanaticExplosionDirectFallbackEnemyNeutralBuilding"/>
        <EffectArray value="NodFanaticExplosionDirectFallbackEnemyNeutralUnit"/>
    </CEffectSet>
</Catalog>