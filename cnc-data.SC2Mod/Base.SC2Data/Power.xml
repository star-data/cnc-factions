<Catalog>

    <CBehaviorBuff id="CnCMaximumGlobalPower" default="1">
        <EditorCategories value="Race:Genetron,AbilityorEffectType:Units"/>
        <DisableValidatorArray value="CasterNotLockedDown"/>
        <DisableValidatorArray value="CasterIsNotUnderConstruction"/>
        <DisableValidatorArray value="CasterIsNotHidden"/>
        <DisableValidatorArray value="NotHidden"/>
        <RemoveValidatorArray value="CasterNotDead"/>
        <RemoveValidatorArray value="GenetronUnitOwnerNotChanged"/>
        <MaxStackCount value="0"/>
        <Modification>
            <VitalMaxIncreaseAffectsCurrentArray index="Energy" value="0"/>
        </Modification>
        <!--        <InfoFlags index="Hidden" value="1"/>-->
    </CBehaviorBuff>





    <!--+100Max -->
    <CBehaviorBuff id="CnCMaximumGlobalPower100" parent="CnCMaximumGlobalPower">
        <Modification>
            <VitalMaxArray index="Energy" value="100"/>
        </Modification>
    </CBehaviorBuff>
    <CAccumulatorBehavior id="CnCMaximumGlobalPower100_StackTarget">
        <Behavior value="CnCMaximumGlobalPower100"/>
        <UnitSource Value="Target"/>
    </CAccumulatorBehavior>
    <CAccumulatorBehavior id="CnCMaximumGlobalPower100_StackCaster">
        <Behavior value="CnCMaximumGlobalPower100"/>
    </CAccumulatorBehavior>
    <CAccumulatorArithmetic id="CnCMaximumGlobalPower100_Arith">
        <Parameters value="0">
            <AccumulatorArray value="CnCMaximumGlobalPower100_StackTarget"/>
        </Parameters>
        <Parameters value="0">
            <AccumulatorArray value="CnCMaximumGlobalPower100_StackCaster"/>
        </Parameters>
        <Operation value="Subtract"/>
    </CAccumulatorArithmetic>
    <CEffectUserData id="MirrorGenetronPowerSupply100Data">
        <EditorCategories value="Race:Neutral"/>
        <Amount value="0">
            <AccumulatorArray value="CnCMaximumGlobalPower100_Arith"/>
        </Amount>
        <Operation value="Set"/>
        <ValidateMax value="500000"/>
        <EffectSuccess value="MirrorGenetronPowerSupply100AB"/>
        <EffectFailure value="MirrorGenetronPowerSupply100RBSet"/>
    </CEffectUserData>
    <CEffectSet id="MirrorGenetronPowerSupply100RBSet">
        <EditorCategories value="Race:Genetron"/>
        <EffectArray value="MirrorGenetronPowerSupply100RB"/>
        <EffectArray value="MirrorGenetronPowerSupply100Data"/>
    </CEffectSet>
    <CEffectApplyBehavior id="MirrorGenetronPowerSupply100AB">
        <EditorCategories value="Race:Genetron"/>
        <WhichUnit Value="Caster"/>
        <Behavior value="CnCMaximumGlobalPower100"/>
        <Count value="0">
            <AccumulatorArray value="DefaultDataAdd"/>
        </Count>
    </CEffectApplyBehavior>
    <CEffectRemoveBehavior id="MirrorGenetronPowerSupply100RB">
        <WhichUnit Value="Caster"/>
        <BehaviorLink value="CnCMaximumGlobalPower100"/>
    </CEffectRemoveBehavior>
    <CEffectApplyBehavior id="TrackGenetronPowerSupply100AB">
        <WhichUnit Value="Caster"/>
        <Behavior value="CnCMaximumGlobalPower100"/>
    </CEffectApplyBehavior>

    <!--+25Max -->
    <CBehaviorBuff id="CnCMaximumGlobalPower25" parent="CnCMaximumGlobalPower">
        <Modification>
            <VitalMaxArray index="Energy" value="25"/>
        </Modification>
    </CBehaviorBuff>
    <CAccumulatorBehavior id="CnCMaximumGlobalPower25_StackTarget">
        <Behavior value="CnCMaximumGlobalPower25"/>
        <UnitSource Value="Target"/>
    </CAccumulatorBehavior>
    <CAccumulatorBehavior id="CnCMaximumGlobalPower25_StackCaster">
        <Behavior value="CnCMaximumGlobalPower25"/>
    </CAccumulatorBehavior>
    <CAccumulatorArithmetic id="CnCMaximumGlobalPower25_Arith">
        <Parameters value="0">
            <AccumulatorArray value="CnCMaximumGlobalPower25_StackTarget"/>
        </Parameters>
        <Parameters value="0">
            <AccumulatorArray value="CnCMaximumGlobalPower25_StackCaster"/>
        </Parameters>
        <Operation value="Subtract"/>
    </CAccumulatorArithmetic>
    <CEffectUserData id="MirrorGenetronPowerSupply25Data">
        <EditorCategories value="Race:Neutral"/>
        <Amount value="0">
            <AccumulatorArray value="CnCMaximumGlobalPower25_Arith"/>
        </Amount>
        <Operation value="Set"/>
        <ValidateMax value="500000"/>
        <EffectSuccess value="MirrorGenetronPowerSupply25AB"/>
        <EffectFailure value="MirrorGenetronPowerSupply25RBSet"/>
    </CEffectUserData>
    <CEffectSet id="MirrorGenetronPowerSupply25RBSet">
        <EditorCategories value="Race:Genetron"/>
        <EffectArray value="MirrorGenetronPowerSupply25RB"/>
        <EffectArray value="MirrorGenetronPowerSupply25Data"/>
    </CEffectSet>
    <CEffectApplyBehavior id="MirrorGenetronPowerSupply25AB">
        <EditorCategories value="Race:Genetron"/>
        <WhichUnit Value="Caster"/>
        <Behavior value="CnCMaximumGlobalPower25"/>
        <Count value="0">
            <AccumulatorArray value="DefaultDataAdd"/>
        </Count>
    </CEffectApplyBehavior>
    <CEffectRemoveBehavior id="MirrorGenetronPowerSupply25RB">
        <EditorCategories value="Race:Genetron"/>
        <WhichUnit Value="Caster"/>
        <BehaviorLink value="CnCMaximumGlobalPower25"/>
    </CEffectRemoveBehavior>
    <CEffectApplyBehavior id="TrackGenetronPowerSupply25AB">
        <WhichUnit Value="Caster"/>
        <Behavior value="CnCMaximumGlobalPower25"/>
    </CEffectApplyBehavior>

    <CEffectCreateHealer id="CnCPowerHealer" default="1">
        <ValidatorArray value="GenetronEnergyGenValidators"/>
        <EditorCategories value="Race:Neutral"/>
        <Flags index="Channeled" value="0"/>
        <Flags index="ContinueWhenFull" value="1"/>
        <PeriodicValidator value="GenetronEnergyGenValidators"/>
        <RechargeVital value="Energy"/>
        <RechargeVitalRate value="0.7148"/>
        <InitialEffect value="DataDefaultSet1"/>
        <FinalEffect value="DataDefaultSet0"/>
    </CEffectCreateHealer>
    <!--1.43 per second ~ 30 Energy Points (Upgraded PowerPlant) -->
    <CEffectCreateHealer id="CnCPowerHealer030" parent="CnCPowerHealer">
        <RechargeVitalRate value="1.4298"/>
    </CEffectCreateHealer>
    <!--0.71 per second ~ 15 Energy Points (PowerPlant) -->
    <CEffectCreateHealer id="CnCPowerHealer015" parent="CnCPowerHealer">
        <RechargeVitalRate value="0.7148"/>
    </CEffectCreateHealer>
    <!--0.24 per second ~ 5 Energy Points (ConsructionYard) -->
    <CEffectCreateHealer id="CnCPowerHealer005" parent="CnCPowerHealer">
        <RechargeVitalRate value="0.2383"/>
    </CEffectCreateHealer>
    <CEffectEnumTrackedUnits id="CnCPowerETU" default="1">
        <?token id="level"?>
        <ValidatorArray value="CasterDataDefaultIs0"/>
        <ValidatorArray value="CasterNotLockedDown"/>
        <ValidatorArray value="CasterIsNotHidden"/>
        <ValidatorArray value="CasterNotDead"/>
        <ValidatorArray value="CasterIsNotUnderConstruction"/>
        <EditorCategories value="Race:Genetron"/>
        <BehaviorLink value="GenetronPowerSupplyTracker"/>
        <Effect value="CnCPowerHealer##level##"/>
    </CEffectEnumTrackedUnits>
    <CEffectEnumTrackedUnits id="CnCPowerETU030" parent="CnCPowerETU" level="030"/>
    <CEffectEnumTrackedUnits id="CnCPowerETU015" parent="CnCPowerETU" level="015"/>
    <CEffectEnumTrackedUnits id="CnCPowerETU005" parent="CnCPowerETU" level="005"/>

    <CValidatorUnitType id="CasterIsNodPowerPlant">
        <WhichUnit Value="Caster"/>
        <Value value="NodPowerPlant"/>
    </CValidatorUnitType>
    <CValidatorUnitType id="CasterIsNodConstructionYard">
        <WhichUnit Value="Caster"/>
        <Value value="NodConstructionYard"/>
    </CValidatorUnitType>


    <CBehaviorBuff id="CnCPowerSupply100"/>
    <CBehaviorBuff id="CnCPowerSupply25"/>
    <CValidatorUnitCompareBehaviorCount id="HasCnCPowerSupply100">
        <WhichUnit Value="Caster"/>
        <Value value="1"/>
        <Behavior value="CnCPowerSupply100"/>
    </CValidatorUnitCompareBehaviorCount>
    <CValidatorUnitCompareBehaviorCount id="HasCnCPowerSupply25">
        <WhichUnit Value="Caster"/>
        <Value value="1"/>
        <Behavior value="CnCPowerSupply25"/>
    </CValidatorUnitCompareBehaviorCount>



    <CEffectSwitch id="TrackGenetronPowerSupplyEnergySwitch">
        <CaseArray Validator="HasCnCPowerSupply100" Effect="TrackGenetronPowerSupply100AB"/>
        <CaseArray Validator="HasCnCPowerSupply25" Effect="TrackGenetronPowerSupply25AB"/>
<!--        <CaseArray Validator="CasterIsNodPowerPlant" Effect="TrackGenetronPowerSupply100AB"/>-->
<!--        <CaseArray Validator="CasterIsNodConstructionYard" Effect="TrackGenetronPowerSupply25AB"/>-->
<!--        <CaseArray Validator="CasterIsCNCEnergyGenerator5" Effect="CNCMaximumPower5"/>-->
<!--        <CaseArray Validator="CasterIsCNCEnergyGenerator10" Effect="CNCMaximumPower10"/>-->
<!--        <CaseArray Validator="CasterIsCNCEnergyGenerator15" Effect="CNCMaximumPower15"/>-->
    </CEffectSwitch>
    <CBehaviorBuff id="CnCPowerGeneration" default="1">
        <?token id="level"?>
<!--        <InfoFlags index="Hidden" value="1"/>-->
        <InfoIcon value="Assets\Textures\btn-tips-computerterminals.dds"/>
        <EditorCategories value="Race:Genetron,AbilityorEffectType:Units"/>
        <DisableValidatorArray value="NotUnderConstruction"/>
        <DisableValidatorArray value="StructureNotLockedDown"/>
        <DisableValidatorArray value="CasterIsNotHidden"/>
        <DisableValidatorArray value="CasterDataDefaultIs0"/>
        <Period value="0.5"/>
        <InitialEffect value="CnCPowerETU##level##"/>
        <PeriodicEffect value="CnCPowerETU##level##"/>
    </CBehaviorBuff>
    <CBehaviorBuff parent="CnCPowerGeneration" id="CnCPowerGeneration030" level="030"/>
    <CBehaviorBuff parent="CnCPowerGeneration"  id="CnCPowerGeneration015" level="015"/>
    <CBehaviorBuff parent="CnCPowerGeneration"  id="CnCPowerGeneration005" level="005"/>





    <CBehaviorBuff default="1" id="CNCEnergyDrain">
        <InitialEffect value="CNCEnergyDrainSet"/>
        <DisableValidatorArray value="GenetronPowerSupplyGE05"/>
        <Period value="0.125"/>
        <PeriodicEffect value="CNCEnergyDrainPowerEnum"/>
    </CBehaviorBuff>
    <CBehaviorBuff id="CNCEnergyDrain5" parent="CNCEnergyDrain"/>
    <CBehaviorBuff id="CNCEnergyDrain10" parent="CNCEnergyDrain"/>
    <CBehaviorBuff id="CNCEnergyDrain15" parent="CNCEnergyDrain"/>
    <CEffectSet id="CNCEnergyDrainSet">
        <EffectArray value="GenetronPowerSupplyTracker"/>
        <EffectArray value="TrackGenetronPowerSupplyUnit"/>
    </CEffectSet>
    <CEffectEnumTrackedUnits id="CNCEnergyDrainPowerEnum">
        <ValidatorArray value="CasterDataDefaultIs0"/>
        <BehaviorLink value="GenetronPowerSupplyTracker"/>
        <Effect value="CNCEnergyDrainPowerEnumPowerRateSwitch"/>
    </CEffectEnumTrackedUnits>
    <CEffectSwitch id="CNCEnergyDrainPowerEnumPowerRateSwitch">
        <CaseArray Validator="CNCEnergyDrain5" Effect="CNCEnergyDrainPowerEnumPowerRate5"/>
        <CaseArray Validator="CNCEnergyDrain10" Effect="CNCEnergyDrainPowerEnumPowerRate10"/>
        <CaseArray Validator="CNCEnergyDrain15" Effect="CNCEnergyDrainPowerEnumPowerRate15"/>
    </CEffectSwitch>
    <CEffectCreateHealer  id="CNCEnergyDrainPowerEnumPowerRate">
        <LaunchUnit Value="Target"/>
        <Flags index="Channeled" value="0"/>
        <Flags index="ContinueWhenFull" value="1"/>
        <!--        <PeriodicValidator value="CasterHasSubterraneanSensors"/>-->
        <DrainVital value="Energy"/>
        <DrainVitalCostFactor value="1"/>
<!--        <RechargeVitalRate value="0.2382"/>-->
<!--        <RechargeVitalRate value="2.1445"/>-->
        <InitialEffect value="DataDefaultSet1"/>
        <FinalEffect value="DataDefaultSet0"/>
    </CEffectCreateHealer>
    <CEffectCreateHealer id="CNCEnergyDrainPowerEnumPowerRate5" parent="CNCEnergyDrainPowerEnumPowerRate">
        <RechargeVitalRate value="0.2382"/>
    </CEffectCreateHealer>
    <CEffectCreateHealer id="CNCEnergyDrainPowerEnumPowerRate10" parent="CNCEnergyDrainPowerEnumPowerRate">
        <RechargeVitalRate value="0.4765"/>
    </CEffectCreateHealer>
    <CEffectCreateHealer id="CNCEnergyDrainPowerEnumPowerRate15" parent="CNCEnergyDrainPowerEnumPowerRate">
        <RechargeVitalRate value="0.7148"/>
    </CEffectCreateHealer>
    <CValidatorUnitCompareBehaviorCount id="CNCEnergyDrain5"><WhichUnit Value="Caster"/><Value value="1"/><Behavior value="CNCEnergyDrain5"/></CValidatorUnitCompareBehaviorCount>
    <CValidatorUnitCompareBehaviorCount id="CNCEnergyDrain10"><WhichUnit Value="Caster"/><Value value="1"/><Behavior value="CNCEnergyDrain10"/></CValidatorUnitCompareBehaviorCount>
    <CValidatorUnitCompareBehaviorCount id="CNCEnergyDrain15"><WhichUnit Value="Caster"/><Value value="1"/><Behavior value="CNCEnergyDrain15"/></CValidatorUnitCompareBehaviorCount>

<!--    <CValidatorUnitCompareBehaviorCount id="CasterIsCNCEnergyGenerator5"><WhichUnit Value="Caster"/><Value value="1"/><Behavior value="CNCEnergyGenerator5"/></CValidatorUnitCompareBehaviorCount>-->
<!--    <CValidatorUnitCompareBehaviorCount id="CasterIsCNCEnergyGenerator10"><WhichUnit Value="Caster"/><Value value="1"/><Behavior value="CNCEnergyGenerator10"/></CValidatorUnitCompareBehaviorCount>-->
<!--    <CValidatorUnitCompareBehaviorCount id="CasterIsCNCEnergyGenerator15"><WhichUnit Value="Caster"/><Value value="1"/><Behavior value="CNCEnergyGenerator15"/></CValidatorUnitCompareBehaviorCount>-->

<!--    <CEffectApplyBehavior id="GenetronPowerSupplyTracker">-->
<!--        <Behavior value="GenetronPowerSupplyTracker"/>-->
<!--    </CEffectApplyBehavior>-->
<!--    <CEffectApplyBehavior id="TrackGenetronPowerSupplyUnit">-->
<!--        <Behavior value="TrackGenetronPowerSupplyUnit"/>-->
<!--    </CEffectApplyBehavior>-->
<!--    <CEffectApplyBehavior id="TrackAndMirrorGenetronPowerSupply">-->
<!--        <Behavior value="TrackAndMirrorGenetronPowerSupply"/>-->
<!--    </CEffectApplyBehavior>-->

    <CEffectSet id="MirrorGenetronPowerSupplySet2">
        <EffectArray value="MirrorGenetronPowerSupplyProcessingCoreData"/>
        <EffectArray value="MirrorGenetronPowerSupply100Data"/>
        <EffectArray value="MirrorGenetronPowerSupply25Data"/>
    </CEffectSet>
    <CEffectSet id="MirrorGenetronPowerSupplyRBSet2">
        <EffectArray value="MirrorGenetronPowerSupplyProcessingCoreRB"/>
        <EffectArray value="MirrorGenetronPowerSupply100RB"/>
        <EffectArray value="MirrorGenetronPowerSupply25RB"/>
    </CEffectSet>
    <CEffectSet id="MirrorGenetronPowerSupplySet">
        <EffectArray index="1" value="MirrorGenetronPowerSupplySet2"/>
    </CEffectSet>
    <CEffectSet id="MirrorGenetronPowerSupplyRBSet">
        <EffectArray index="0" value="MirrorGenetronPowerSupplyRBSet2"/>
    </CEffectSet>
</Catalog>